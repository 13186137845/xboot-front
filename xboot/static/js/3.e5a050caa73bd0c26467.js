webpackJsonp([3],{A6ef:function(e,t,n){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=n("3cXf"),r=n.n(o),a={name:"role-manage",data:function(){return{loading:!0,modalType:0,menuModalVisible:!1,selectList:[],selectCount:0,menuForm:{name:"",parent:!1,access:null,parentId:"",component:""},menuFormAdd:{name:"",parent:!1,access:null,parentId:"",component:""},isChild:!0,isChildAdd:!0,errorParent:"",errorParentAdd:"",menuFormValidate:{name:[{required:!0,message:"菜单名称不能为空",trigger:"blur"}],title:[{required:!0,message:"标题不能为空",trigger:"blur"}],icon:[{required:!0,message:"图标不能为空",trigger:"blur"}],path:[{required:!0,message:"路径不能为空",trigger:"blur"}],component:[{required:!0,message:"前端组件不能为空",trigger:"blur"}]},submitLoading:!1,data:[]}},methods:{init:function(){this.getMenuList()},getMenuList:function(){var e=this;this.loading=!0,this.getRequest("/menu/getAllList").then(function(t){e.loading=!1,!0===t.success&&(t.result.forEach(function(e){e.expand=!0}),e.data=t.result)})},selectTree:function(e){if(e.length>0){for(var t in e[0])null===e[0][t]&&(e[0][t]="");var n=r()(e[0]),o=JSON.parse(n);""===o.access&&(o.access=null),this.menuForm=o,this.changeParent()}},changeParent:function(){this.menuForm.parent?this.isChild=!1:this.isChild=!0},changeParentAdd:function(){this.menuFormAdd.parent?this.isChildAdd=!1:this.isChildAdd=!0},cancelAdd:function(){this.menuModalVisible=!1},handleReset:function(){this.$refs.menuForm.resetFields()},submitEdit:function(){var e=this;this.$refs.menuForm.validate(function(t){if(t){if(e.isChild&&""===e.menuForm.parentId)return void(e.errorParent="不能为空");if(e.errorParent="",void 0===e.menuForm.id||""===e.menuForm.id||null===e.menuForm.id)return void e.$Message.warning("请先点击选择要修改的菜单节点");e.submitLoading=!0,null===e.menuForm.access&&(e.menuForm.access=""),e.postRequest("/menu/edit",e.menuForm).then(function(t){e.submitLoading=!1,!0===t.success&&(e.$Message.success("编辑成功"),e.init(),e.menuModalVisible=!1)})}})},submitAdd:function(){var e=this;this.$refs.menuFormAdd.validate(function(t){if(t){if(e.isChildAdd&&""===e.menuFormAdd.parentId)return void(e.errorParentAdd="不能为空");e.errorParentAdd="",e.submitLoading=!0,null===e.menuFormAdd.access&&(e.menuFormAdd.access=""),e.postRequest("/menu/add",e.menuFormAdd).then(function(t){e.submitLoading=!1,!0===t.success&&(e.$Message.success("添加成功"),e.init(),e.menuModalVisible=!1)})}})},addMenu:function(){this.menuFormAdd={name:"",parent:!1,access:null,parentId:"",component:""},this.changeParentAdd(),this.menuModalVisible=!0},changeSelect:function(e){this.selectCount=e.length,this.selectList=e},delAll:function(){var e=this;this.selectCount<=0?this.$Message.warning("您还未选择要删除的数据"):this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectCount+" 条数据?",onOk:function(){var t="";e.selectList.forEach(function(e){t+=e.id+","}),t=t.substring(0,t.length-1),e.deleteRequest("/menu/delByIds",{ids:t}).then(function(t){!0===t.success&&(e.$Message.success("删除成功"),e.init())})}})}},mounted:function(){this.init()}},s={render:function(){var e=this,t=e.$createElement,n=e._self._c||t;return n("div",{staticClass:"search"},[n("Card",[n("Row",{staticClass:"operation"},[n("Button",{attrs:{type:"primary",icon:"plus-round"},on:{click:e.addMenu}},[e._v("添加菜单")]),e._v(" "),n("Button",{attrs:{type:"ghost",icon:"trash-a"},on:{click:e.delAll}},[e._v("批量删除")]),e._v(" "),n("Button",{attrs:{type:"ghost",icon:"refresh"},on:{click:e.getMenuList}},[e._v("刷新")])],1),e._v(" "),n("Row",{staticClass:"code-row-bg",attrs:{type:"flex",justify:"start"}},[n("Col",{attrs:{span:"6"}},[n("Tree",{attrs:{data:e.data,"show-checkbox":""},on:{"on-check-change":e.changeSelect,"on-select-change":e.selectTree}}),e._v(" "),e.loading?n("Spin",{attrs:{size:"large",fix:""}}):e._e()],1),e._v(" "),n("Col",{attrs:{span:"9"}},[n("Form",{ref:"menuForm",attrs:{model:e.menuForm,"label-width":80,rules:e.menuFormValidate}},[n("FormItem",{attrs:{label:"菜单ID",prop:"id"}},[n("Input",{attrs:{readonly:""},model:{value:e.menuForm.id,callback:function(t){e.$set(e.menuForm,"id",t)},expression:"menuForm.id"}})],1),e._v(" "),n("FormItem",{attrs:{label:"菜单名称",prop:"name"}},[n("Input",{model:{value:e.menuForm.name,callback:function(t){e.$set(e.menuForm,"name",t)},expression:"menuForm.name"}})],1),e._v(" "),n("FormItem",{attrs:{label:"标题",prop:"title"}},[n("Input",{model:{value:e.menuForm.title,callback:function(t){e.$set(e.menuForm,"title",t)},expression:"menuForm.title"}})],1),e._v(" "),n("FormItem",{staticStyle:{"margin-bottom":"5px"},attrs:{label:"图标",prop:"icon"}},[n("Input",{model:{value:e.menuForm.icon,callback:function(t){e.$set(e.menuForm,"icon",t)},expression:"menuForm.icon"}}),e._v(" "),n("span",[e._v("\n                  图标请参考 "),n("a",{attrs:{target:"_blank",href:"http://ionicons.com/"}},[n("Icon",{attrs:{type:"ionic"}}),e._v(" ionicons")],1)])],1),e._v(" "),n("FormItem",{attrs:{label:"路径",prop:"path"}},[n("Input",{model:{value:e.menuForm.path,callback:function(t){e.$set(e.menuForm,"path",t)},expression:"menuForm.path"}})],1),e._v(" "),n("FormItem",{attrs:{label:"前端组件",prop:"component"}},[n("Input",{model:{value:e.menuForm.component,callback:function(t){e.$set(e.menuForm,"component",t)},expression:"menuForm.component"}})],1),e._v(" "),n("FormItem",{attrs:{label:"一级菜单",prop:"parent"}},[n("i-switch",{attrs:{size:"large"},on:{"on-change":e.changeParent},model:{value:e.menuForm.parent,callback:function(t){e.$set(e.menuForm,"parent",t)},expression:"menuForm.parent"}},[n("span",{attrs:{slot:"open"},slot:"open"},[e._v("是")]),e._v(" "),n("span",{attrs:{slot:"close"},slot:"close"},[e._v("否")])])],1),e._v(" "),e.isChild?n("FormItem",{attrs:{label:"父级菜单ID",prop:"parentId",error:e.errorParent}},[n("Input",{model:{value:e.menuForm.parentId,callback:function(t){e.$set(e.menuForm,"parentId",t)},expression:"menuForm.parentId"}})],1):e._e(),e._v(" "),n("FormItem",{attrs:{label:"所需权限值",prop:"access"}},[n("InputNumber",{attrs:{max:1e3,min:-1e3},model:{value:e.menuForm.access,callback:function(t){e.$set(e.menuForm,"access",t)},expression:"menuForm.access"}}),e._v(" "),n("span",{staticStyle:{"margin-left":"5px"}},[e._v("不填则始终显示")])],1),e._v(" "),n("Form-item",[n("Button",{attrs:{loading:e.submitLoading,type:"primary",icon:"compose"},on:{click:e.submitEdit}},[e._v("修改")]),e._v(" "),n("Button",{attrs:{type:"ghost"},on:{click:e.handleReset}},[e._v("重置")])],1)],1)],1)],1)],1),e._v(" "),n("Modal",{attrs:{title:"添加菜单","mask-closable":!1,width:500},model:{value:e.menuModalVisible,callback:function(t){e.menuModalVisible=t},expression:"menuModalVisible"}},[n("Form",{ref:"menuFormAdd",attrs:{model:e.menuFormAdd,"label-width":80,rules:e.menuFormValidate}},[n("FormItem",{attrs:{label:"菜单名称",prop:"name"}},[n("Input",{model:{value:e.menuFormAdd.name,callback:function(t){e.$set(e.menuFormAdd,"name",t)},expression:"menuFormAdd.name"}})],1),e._v(" "),n("FormItem",{attrs:{label:"标题",prop:"title"}},[n("Input",{model:{value:e.menuFormAdd.title,callback:function(t){e.$set(e.menuFormAdd,"title",t)},expression:"menuFormAdd.title"}})],1),e._v(" "),n("FormItem",{staticStyle:{"margin-bottom":"5px"},attrs:{label:"图标",prop:"icon"}},[n("Input",{model:{value:e.menuFormAdd.icon,callback:function(t){e.$set(e.menuFormAdd,"icon",t)},expression:"menuFormAdd.icon"}}),e._v(" "),n("span",[e._v("\n                  图标请参考 "),n("a",{attrs:{target:"_blank",href:"http://ionicons.com/"}},[n("Icon",{attrs:{type:"ionic"}}),e._v(" ionicons")],1)])],1),e._v(" "),n("FormItem",{attrs:{label:"路径",prop:"path"}},[n("Input",{model:{value:e.menuFormAdd.path,callback:function(t){e.$set(e.menuFormAdd,"path",t)},expression:"menuFormAdd.path"}})],1),e._v(" "),n("FormItem",{attrs:{label:"前端组件",prop:"component"}},[n("Input",{model:{value:e.menuFormAdd.component,callback:function(t){e.$set(e.menuFormAdd,"component",t)},expression:"menuFormAdd.component"}})],1),e._v(" "),n("FormItem",{attrs:{label:"一级菜单",prop:"parent"}},[n("i-switch",{attrs:{size:"large"},on:{"on-change":e.changeParentAdd},model:{value:e.menuFormAdd.parent,callback:function(t){e.$set(e.menuFormAdd,"parent",t)},expression:"menuFormAdd.parent"}},[n("span",{attrs:{slot:"open"},slot:"open"},[e._v("是")]),e._v(" "),n("span",{attrs:{slot:"close"},slot:"close"},[e._v("否")])])],1),e._v(" "),e.isChildAdd?n("FormItem",{attrs:{label:"父级菜单ID",prop:"parentId",error:e.errorParentAdd}},[n("Input",{model:{value:e.menuFormAdd.parentId,callback:function(t){e.$set(e.menuFormAdd,"parentId",t)},expression:"menuFormAdd.parentId"}})],1):e._e(),e._v(" "),n("FormItem",{attrs:{label:"所需权限值",prop:"access"}},[n("InputNumber",{attrs:{max:1e3,min:-1e3},model:{value:e.menuFormAdd.access,callback:function(t){e.$set(e.menuFormAdd,"access",t)},expression:"menuFormAdd.access"}}),e._v(" "),n("span",{staticStyle:{"margin-left":"5px"}},[e._v("不填则始终显示")])],1)],1),e._v(" "),n("div",{attrs:{slot:"footer"},slot:"footer"},[n("Button",{attrs:{type:"text"},on:{click:e.cancelAdd}},[e._v("取消")]),e._v(" "),n("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.submitAdd}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var i=n("Z0/y")(a,s,!1,function(e){n("Jxdc")},null,null);t.default=i.exports},Jxdc:function(e,t){}});
//# sourceMappingURL=3.e5a050caa73bd0c26467.js.map