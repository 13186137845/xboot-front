webpackJsonp([5],{"D+CQ":function(e,t,s){"use strict";Object.defineProperty(t,"__esModule",{value:!0});var o=s("3cXf"),l=s.n(o),i={name:"role-manage",data:function(){var e=this;return{loading:!0,modalType:0,roleModalVisible:!1,modalTitle:"",roleForm:{name:"",access:null},roleFormValidate:{name:[{required:!0,message:"角色名称不能为空",trigger:"blur"}]},submitLoading:!1,selectList:[],selectCount:0,columns:[{type:"selection",width:60,align:"center"},{title:"角色名称",key:"name",sortable:!0},{title:"对应权限值",key:"access",sortable:!0},{title:"创建时间",key:"createTime",sortable:!0},{title:"更新时间",key:"updateTime",sortable:!0},{title:"是否设置为注册用户默认角色",key:"defaultRole",align:"center",render:function(t,s){return s.row.defaultRole?t("div",[t("Button",{props:{type:"success",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.cancelDefault(s.row)}}},"取消默认")]):t("div",[t("Button",{props:{type:"info",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.setDefault(s.row)}}},"设为默认")])}},{title:"操作",key:"action",width:200,align:"center",render:function(t,s){return t("div",[t("Button",{props:{type:"primary",size:"small"},style:{marginRight:"5px"},on:{click:function(){e.edit(s.row)}}},"编辑"),t("Button",{props:{type:"error",size:"small"},on:{click:function(){e.remove(s.row)}}},"删除")])}}],data:[],pageNumber:1,pageSize:10,total:0}},methods:{init:function(){this.getRoleList()},changePage:function(e){this.pageNumber=e,this.getRoleList()},changePageSize:function(e){this.pageSize=e,this.getRoleList()},getRoleList:function(){var e=this;this.loading=!0;var t={pageNumber:this.pageNumber,pageSize:this.pageSize,sort:"createTime"};this.getRequest("/role/getAllByPage",t).then(function(t){e.loading=!1,!0===t.success&&(e.data=t.result.content,e.total=t.result.totalElements)})},cancelRole:function(){this.roleModalVisible=!1},submitRole:function(){var e=this;this.$refs.roleForm.validate(function(t){if(t){var s="/role/add";1===e.modalType&&(s="/role/edit"),e.submitLoading=!0,e.postRequest(s,e.roleForm).then(function(t){e.submitLoading=!1,!0===t.success&&(e.$Message.success("操作成功"),e.init(),e.roleModalVisible=!1)})}})},addUser:function(){this.modalType=0,this.modalTitle="添加角色",this.roleForm={name:"",access:null},this.roleModalVisible=!0},edit:function(e){for(var t in this.modalType=1,this.modalTitle="编辑角色",e)null===e[t]&&(e[t]="");var s=l()(e),o=JSON.parse(s);this.roleForm=o,this.roleModalVisible=!0},remove:function(e){var t=this;this.$Modal.confirm({title:"确认删除",content:"您确认要删除角色 "+e.name+" ?",onOk:function(){t.deleteRequest("/role/delAllByIds",{ids:e.id}).then(function(e){!0===e.success&&(t.$Message.success("删除成功"),t.init())})}})},setDefault:function(e){var t=this;this.$Modal.confirm({title:"确认设置",content:"您确认要设置所选的 "+e.name+" 为注册用户默认角色?",onOk:function(){var s={id:e.id,isDefault:!0};t.postRequest("/role/setDefault",s).then(function(e){!0===e.success&&(t.$Message.success("操作成功"),t.init())})}})},cancelDefault:function(e){var t=this;this.$Modal.confirm({title:"确认取消",content:"您确认要取消所选的 "+e.name+" 角色为默认?",onOk:function(){var s={id:e.id,isDefault:!1};t.postRequest("/role/setDefault",s).then(function(e){!0===e.success&&(t.$Message.success("操作成功"),t.init())})}})},clearSelectAll:function(){this.$refs.table.selectAll(!1)},changeSelect:function(e){this.selectList=e,this.selectCount=e.length},delAll:function(){var e=this;this.selectCount<=0?this.$Message.warning("您还未选择要删除的数据"):this.$Modal.confirm({title:"确认删除",content:"您确认要删除所选的 "+this.selectCount+" 条数据?",onOk:function(){var t="";e.selectList.forEach(function(e){t+=e.id+","}),t=t.substring(0,t.length-1),e.deleteRequest("/role/delAllByIds",{ids:t}).then(function(t){!0===t.success&&(e.$Message.success("删除成功"),e.init())})}})}},mounted:function(){this.init()}},n={render:function(){var e=this,t=e.$createElement,s=e._self._c||t;return s("div",{staticClass:"search"},[s("Row",[s("Col",[s("Card",[s("Row",{staticClass:"operation"},[s("Button",{attrs:{type:"primary",icon:"plus-round"},on:{click:e.addUser}},[e._v("添加角色")]),e._v(" "),s("Button",{attrs:{type:"ghost",icon:"trash-a"},on:{click:e.delAll}},[e._v("批量删除")]),e._v(" "),s("Button",{attrs:{type:"ghost",icon:"refresh"},on:{click:e.getRoleList}},[e._v("刷新")])],1),e._v(" "),s("Row",[s("Alert",{attrs:{"show-icon":""}},[e._v("\n                        已选择 "),s("span",{staticClass:"select-count"},[e._v(e._s(e.selectCount))]),e._v(" 项\n                        "),s("a",{staticClass:"select-clear",on:{click:e.clearSelectAll}},[e._v("清空")])])],1),e._v(" "),s("Row",{staticClass:"margin-top-10 searchable-table-con1"},[s("Table",{ref:"table",attrs:{loading:e.loading,border:"",columns:e.columns,data:e.data},on:{"on-selection-change":e.changeSelect}})],1),e._v(" "),s("Row",{staticClass:"code-row-bg page",attrs:{type:"flex",justify:"end"}},[s("Page",{attrs:{current:this.pageNumber,total:e.total,"page-size":this.pageSize,"page-size-opts":[10,20,50,100],size:"small","show-total":"","show-elevator":"","show-sizer":""},on:{"on-change":e.changePage,"on-page-size-change":e.changePageSize}})],1)],1)],1)],1),e._v(" "),s("Modal",{attrs:{title:e.modalTitle,"mask-closable":!1,width:500},model:{value:e.roleModalVisible,callback:function(t){e.roleModalVisible=t},expression:"roleModalVisible"}},[s("Form",{ref:"roleForm",attrs:{model:e.roleForm,"label-width":80,rules:e.roleFormValidate}},[s("FormItem",{attrs:{label:"角色名称",prop:"name"}},[s("Input",{attrs:{placeholder:"按照Spring Security约定请以‘ROLE_’开头"},model:{value:e.roleForm.name,callback:function(t){e.$set(e.roleForm,"name",t)},expression:"roleForm.name"}})],1),e._v(" "),s("FormItem",{attrs:{label:"对应权限值",prop:"access"}},[s("InputNumber",{attrs:{max:1e3,min:-1e3},model:{value:e.roleForm.access,callback:function(t){e.$set(e.roleForm,"access",t)},expression:"roleForm.access"}})],1)],1),e._v(" "),s("div",{attrs:{slot:"footer"},slot:"footer"},[s("Button",{attrs:{type:"text"},on:{click:e.cancelRole}},[e._v("取消")]),e._v(" "),s("Button",{attrs:{type:"primary",loading:e.submitLoading},on:{click:e.submitRole}},[e._v("提交")])],1)],1)],1)},staticRenderFns:[]};var a=s("Z0/y")(i,n,!1,function(e){s("xAP9")},null,null);t.default=a.exports},xAP9:function(e,t){}});
//# sourceMappingURL=5.7368f9469cb3ad1dc037.js.map